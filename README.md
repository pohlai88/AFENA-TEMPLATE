<!-- AUTOGEN:START -->
<!-- Generated by afenda readme gen ‚Äî DO NOT EDIT inside this block -->
<!-- Signature: sha256:f79c97c5d107a3378d71cc96c3c38d779ebf2373d9ca9b6b2b2419a8dda06171 -->

# afenda-monorepo

## Structure

```
afenda-monorepo/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ web/
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îú‚îÄ‚îÄ advisory/
‚îÇ   ‚îú‚îÄ‚îÄ canon/
‚îÇ   ‚îú‚îÄ‚îÄ crud/
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ eslint-config/
‚îÇ   ‚îú‚îÄ‚îÄ logger/
‚îÇ   ‚îú‚îÄ‚îÄ migration/
‚îÇ   ‚îú‚îÄ‚îÄ search/
‚îÇ   ‚îú‚îÄ‚îÄ typescript-config/
‚îÇ   ‚îú‚îÄ‚îÄ ui/
‚îÇ   ‚îî‚îÄ‚îÄ workflow/
‚îú‚îÄ‚îÄ tools/
‚îÇ   ‚îî‚îÄ‚îÄ afenda-cli/
‚îú‚îÄ‚îÄ turbo.json
‚îú‚îÄ‚îÄ pnpm-workspace.yaml
‚îî‚îÄ‚îÄ package.json
```

## Packages

| Package                    | Path                         | Type    | Description |
| -------------------------- | ---------------------------- | ------- | ----------- |
| `web`                      | `apps/web`                   | app     |             |
| `afenda-advisory`          | `packages/advisory`          | library |             |
| `afenda-canon`             | `packages/canon`             | library |             |
| `afenda-crud`              | `packages/crud`              | library |             |
| `afenda-database`          | `packages/database`          | library |             |
| `afenda-eslint-config`     | `packages/eslint-config`     | config  |             |
| `afenda-logger`            | `packages/logger`            | library |             |
| `afenda-migration`         | `packages/migration`         | library |             |
| `afenda-search`            | `packages/search`            | library |             |
| `afenda-typescript-config` | `packages/typescript-config` | config  |             |
| `afenda-ui`                | `packages/ui`                | ui      |             |
| `afenda-workflow`          | `packages/workflow`          | library |             |
| `@afenda/cli`              | `tools/afenda-cli`           | tool    |             |

## Scripts

| Script                       | Command                                                                                  |
| ---------------------------- | ---------------------------------------------------------------------------------------- |
| `pnpm adapter:build`         | `pnpm afenda meta emit-all`                                                              |
| `pnpm afenda`                | `node tools/afenda-cli/dist/index.js`                                                    |
| `pnpm afenda:dev`            | `tsx tools/afenda-cli/src/index.ts`                                                      |
| `pnpm afenda:discover`       | `node tools/afenda-cli/dist/discover.js`                                                 |
| `pnpm audit`                 | `pnpm audit --audit-level=moderate`                                                      |
| `pnpm audit:fix`             | `pnpm audit --fix`                                                                       |
| `pnpm audit:prod`            | `pnpm audit --prod --audit-level=moderate`                                               |
| `pnpm build`                 | `turbo run build`                                                                        |
| `pnpm bundle`                | `pnpm afenda bundle`                                                                     |
| `pnpm bundle:dry`            | `pnpm afenda bundle --dry-run`                                                           |
| `pnpm ci:check`              | `pnpm afenda housekeeping`                                                               |
| `pnpm ci:housekeeping`       | `pnpm bundle`                                                                            |
| `pnpm clean`                 | `turbo run clean`                                                                        |
| `pnpm dev`                   | `turbo run dev`                                                                          |
| `pnpm engine:generate`       | `pnpm --filter afenda-ui engine:generate`                                                |
| `pnpm format`                | `prettier --write "**/*.{ts,tsx,md}"`                                                    |
| `pnpm format:check`          | `prettier --check "**/*.{ts,tsx,md}"`                                                    |
| `pnpm housekeeping`          | `pnpm afenda housekeeping`                                                               |
| `pnpm housekeeping:fix`      | `pnpm afenda housekeeping --fix`                                                         |
| `pnpm lint`                  | `turbo run lint`                                                                         |
| `pnpm lint:ci`               | `turbo run lint:ci`                                                                      |
| `pnpm lint:fix`              | `turbo run lint:fix`                                                                     |
| `pnpm meta:check`            | `pnpm afenda meta check`                                                                 |
| `pnpm meta:gen`              | `pnpm afenda meta gen`                                                                   |
| `pnpm meta:matrix`           | `pnpm afenda meta matrix`                                                                |
| `pnpm postinstall`           | `node -e "try{require('./tools/afenda-cli/dist/discover.js')}catch(e){process.exit(0)}"` |
| `pnpm readme:check`          | `pnpm afenda readme check`                                                               |
| `pnpm readme:gen`            | `pnpm afenda readme gen`                                                                 |
| `pnpm readme:sync`           | `pnpm afenda readme sync`                                                                |
| `pnpm sbom`                  | `pnpm dlx @cyclonedx/cdxgen -r --no-install-deps -o sbom.json`                           |
| `pnpm search:bootstrap`      | `pnpm --filter web search:bootstrap`                                                     |
| `pnpm test:e2e`              | `playwright test --project=chromium`                                                     |
| `pnpm test:e2e:all`          | `playwright test`                                                                        |
| `pnpm test:e2e:codegen`      | `playwright codegen http://localhost:3000`                                               |
| `pnpm test:e2e:debug`        | `playwright test --debug`                                                                |
| `pnpm test:e2e:install`      | `playwright install --with-deps`                                                         |
| `pnpm test:e2e:report`       | `playwright show-report`                                                                 |
| `pnpm test:e2e:ui`           | `playwright test --ui`                                                                   |
| `pnpm type-check`            | `turbo run type-check`                                                                   |
| `pnpm type-check:refs`       | `tsc -b`                                                                                 |
| `pnpm type-check:refs:clean` | `tsc -b --clean && tsc -b`                                                               |
| `pnpm type-check:strict`     | `turbo run type-check -- --strict`                                                       |
| `pnpm ui:add`                | `pnpm dlx shadcn@latest add -c apps/web`                                                 |
| `pnpm ui:diff`               | `pnpm dlx shadcn@latest diff -c apps/web`                                                |
| `pnpm ui:update`             | `pnpm dlx shadcn@latest add -o -c apps/web`                                              |

<!-- AUTOGEN:END -->

A modern monorepo powered by Turborepo, Next.js 16 with Turbopack, and
TypeScript.

## Getting Started

1. Install dependencies:

   ```bash
   pnpm install
   ```

2. Start the development server:

   ```bash
   pnpm dev
   ```

3. Open [http://localhost:3000](http://localhost:3000) to view the application.

## üéØ Important: Configuration & Best Practices

This monorepo follows strict configuration standards for consistency across **64 packages** (10 core packages, 48 business domains, 2 tools, 1 app).

### üìñ Core Documentation

**Start here when working with packages:**

- **[PACKAGE_TEMPLATE.md](packages/PACKAGE_TEMPLATE.md)** - Template for new packages with configuration examples
- **[CONFIGURATION_GUIDE.md](docs/CONFIGURATION_GUIDE.md)** - Complete guide to TypeScript, package.json, and build configs
- **[CONFIG-QUICK-REF.md](docs/CONFIG-QUICK-REF.md)** - Fast lookup for common patterns
- **[GOVERNANCE.md](packages/GOVERNANCE.md)** - Layer restrictions and dependency rules

### ‚öôÔ∏è Configuration Standards

**TypeScript:**

- All packages extend shared presets from `packages/typescript-config/`
- Use `base.json` for standard packages, `react-library.json` for React components, `nextjs.json` for Next.js apps
- Minimize package-specific overrides

**Dependencies:**

- Internal packages: `workspace:*` protocol
- Common external packages: `catalog:` (managed in root)
- Follow [GOVERNANCE.md](packages/GOVERNANCE.md) layer restrictions

**Scripts:**

- Use standardized naming: `type-check`, `lint`, `lint:ci`, `lint:fix`
- All packages must have: `type-check` and `lint`
- Optional: `build`, `dev`, `test`

### ‚úÖ Before Committing

```bash
pnpm type-check    # TypeScript validation
pnpm lint          # Code quality
pnpm lint:ci       # Check for circular dependencies
pnpm build         # Verify builds work
```

### üöÄ Recent Updates

- ‚úÖ Synchronized all 64 TypeScript configurations (see [CONFIG-SYNC-REPORT.md](docs/CONFIG-SYNC-REPORT.md))
- ‚úÖ Next.js 16 optimizations with `verbatimModuleSyntax`
- ‚úÖ Turborepo caching enhancements
- ‚úÖ pnpm workspace optimizations (.npmrc)

## Development Workflow

1. Make changes to packages or apps
2. Turborepo automatically handles dependencies and caching
3. Use `pnpm build` to verify changes
4. Use `pnpm lint` and `pnpm type-check` to ensure code quality

**Lint & type debugging:** Cursor skill at `.cursor/skills/lint-types-debug/` ‚Äî
use when lint or type-check fails, or when debugging INVARIANT/EX-LINT issues.

## Adding New Packages

Follow the comprehensive guide in [CONFIGURATION_GUIDE.md](docs/CONFIGURATION_GUIDE.md#adding-a-new-package) or use this quick checklist:

1. **Create package directory:**

   ```bash
   mkdir packages/my-new-package
   cd packages/my-new-package
   ```

2. **Create `package.json`** (see [PACKAGE_TEMPLATE.md](packages/PACKAGE_TEMPLATE.md) for full template):

   ```json
   {
     "name": "afenda-my-new-package",
     "version": "0.1.0",
     "private": true,
     "type": "module",
     "main": "./src/index.ts",
     "scripts": {
       "type-check": "tsc --noEmit",
       "lint": "eslint . --ext .ts,.tsx --cache"
     },
     "devDependencies": {
       "afenda-typescript-config": "workspace:*",
       "afenda-eslint-config": "workspace:^"
     }
   }
   ```

3. **Create `tsconfig.json`:**

   ```json
   {
     "extends": "afenda-typescript-config/base.json",
     "compilerOptions": {
       "tsBuildInfoFile": "./dist/.tsbuildinfo"
     },
     "include": ["src/**/*"],
     "exclude": ["node_modules", "dist"]
   }
   ```

4. **Create `src/index.ts`** with exports

5. **Validate:**

   ```bash
   pnpm install
   pnpm type-check
   pnpm lint
   ```

6. **Generate README:**
   ```bash
   pnpm afenda readme gen
   ```

**See also:** [CONFIG-QUICK-REF.md](docs/CONFIG-QUICK-REF.md) for copy-paste ready patterns

## Deployment

The monorepo is configured for optimal deployment with Vercel. Each app can be
deployed independently.

## üîß Troubleshooting

### Common Issues

**"Cannot find module 'afenda-typescript-config'"**

```bash
pnpm install  # Re-link workspace dependencies
```

**Circular dependency warnings**

```bash
pnpm lint:ci  # Check which packages have cycles
# See GOVERNANCE.md for layer restrictions
```

**Stale build cache**

```bash
turbo run build --force  # Force rebuild without cache
rm -rf .turbo && pnpm build  # Clear cache completely
```

**TypeScript incremental build issues**

```bash
pnpm -r exec -- rm -rf dist/.tsbuildinfo
pnpm build
```

**ESLint cache issues**

```bash
pnpm -r exec -- rm -rf .eslintcache
pnpm lint
```

**For more troubleshooting:** See [CONFIGURATION_GUIDE.md](docs/CONFIGURATION_GUIDE.md#troubleshooting)

## Learn More

### Monorepo Documentation

- **[CONFIGURATION_GUIDE.md](docs/CONFIGURATION_GUIDE.md)** - Complete configuration management guide
- **[CONFIG-QUICK-REF.md](docs/CONFIG-QUICK-REF.md)** - Quick reference for common patterns
- **[CONFIG-SYNC-REPORT.md](docs/CONFIG-SYNC-REPORT.md)** - Configuration synchronization details
- **[PACKAGE_TEMPLATE.md](packages/PACKAGE_TEMPLATE.md)** - Template for new packages
- **[GOVERNANCE.md](packages/GOVERNANCE.md)** - Layer restrictions and dependency rules
- **[ARCHITECTURE.md](ARCHITECTURE.md)** - System architecture overview
- **[CODING_STANDARDS.md](docs/CODING_STANDARDS.md)** - Code conventions

### Installed Skills

Located in `.agents/skills/`:

- **monorepo-management** - Turborepo, Nx, pnpm workspace patterns
- **pnpm** - Workspace protocol, catalogs, CLI commands
- **next-best-practices** - Next.js conventions and patterns
- **nextjs-16-complete-guide** - Next.js 16 features and migration
- **optimized-nextjs-typescript** - Next.js TypeScript optimization

### External Resources

- [Turborepo Documentation](https://turbo.build/repo/docs)
- [Next.js Documentation](https://nextjs.org/docs)
- [PNPM Workspace Documentation](https://pnpm.io/workspaces)
- [TypeScript Project References](https://www.typescriptlang.org/docs/handbook/project-references.html)
