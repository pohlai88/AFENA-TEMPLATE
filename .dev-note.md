# Afena Nexus — Development Notes

> Core platform complete 2026-02-13. Ready for business logic expansion.

---

## Next Development Priorities

### Immediate (P0) — Business Value

1. **Additional Entity Handlers** — Expand beyond contacts/companies
   - Invoices (doc lifecycle + number sequences)
   - Products/Services (inventory foundation)
   - Use `pnpm db:entity-new <entity>` scaffold + generator
   - Each entity = ~2-3 hours (schema → handler → UI)

2. **Email/Notification System**
   - Transactional emails (Resend/SendGrid)
   - In-app notifications table + UI
   - Template engine for advisory alerts
   - Webhook delivery for external integrations

3. **Dashboard & Analytics**
   - Org-level KPI cards (revenue, aging, advisories)
   - Chart components (recharts already in UI package)
   - Advisory summary view (open/ack counts by severity)
   - Forecast visualization (P10/P50/P90 bands)

### Near-term (P1) — Platform Maturity

4. **CI/CD Pipeline**
   - GitHub Actions workflow (lint → type-check → build → test)
   - Neon branch per PR (ephemeral DB)
   - Vercel preview deployments
   - Invariant gates (ci-invariants.mjs, afena meta check)

5. **E2E Testing Framework**
   - Playwright setup (MCP already configured)
   - Critical path tests (auth → create contact → mutate → audit)
   - Visual regression tests for UI components
   - `testing.architecture.md` documentation

6. **Observability Stack**
   - Sentry for error tracking (Next.js + Neon integration)
   - Vercel Analytics for Web Vitals
   - Pino → structured log aggregation (Axiom/Logtail)
   - `observability.architecture.md` documentation

### Future (P2) — Scale & Polish

7. **Real-time Features**
   - Server-Sent Events for live advisory updates
   - Optimistic UI updates with revalidation
   - Collaborative editing indicators (presence)

8. **Internationalization (i18n)**
   - next-intl setup
   - Currency/number formatting per locale
   - Date/time localization
   - RTL support consideration

9. **Advanced RBAC**
   - Team scope implementation (teams table + RLS)
   - Read masking policies (field-level permissions)
   - Custom role builder UI
   - Permission inheritance visualization

### Deferred (P3) — Nice-to-Have

- REST API routes (server actions sufficient for now)
- Audit partitioning (defer until >1M rows)
- GeoIP population (needs external service)
- Mobile app (web-responsive sufficient)
- API versioning (internal-only API)

---

## Recommended Next Session

**Start with Entity Expansion** (highest ROI):

1. Run `pnpm db:entity-new invoices --company --site --doc-number`
2. Implement invoice lifecycle (draft → submitted → approved → paid)
3. Wire number sequences (INV-2024-0001 auto-generation)
4. Add invoice list/detail/edit pages (copy contacts pattern)
5. Test full CRUD + audit + versions + workflow rules

This validates the platform's extensibility and delivers immediate business value.

---

_Updated: 2026-02-13_
