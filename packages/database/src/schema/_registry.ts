/**
 * Table taxonomy registry â€” SCH-03a/03b. GENERATED by pnpm db:barrel
 * Do not edit manually. Policy lives in table-registry.config.ts and revoke.config.ts
 *
 * table_kind: truth | control | projection | evidence | link | system
 */

export type TableKind = 'truth' | 'control' | 'projection' | 'evidence' | 'link' | 'system';

export const TABLE_REGISTRY = {
  addresses: 'truth',
  advisories: 'system',
  advisory_evidence: 'system',
  api_keys: 'system',
  approval_chains: 'truth',
  approval_decisions: 'truth',
  approval_requests: 'truth',
  approval_steps: 'truth',
  asset_events: 'truth',
  assets: 'truth',
  audit_logs: 'evidence',
  bank_accounts: 'truth',
  bank_reconciliation_sessions: 'truth',
  bank_statement_lines: 'truth',
  bom_lines: 'truth',
  boms: 'truth',
  budget_commitments: 'truth',
  budgets: 'truth',
  chart_of_accounts: 'truth',
  communications: 'truth',
  companies: 'truth',
  company_addresses: 'link',
  contact_addresses: 'link',
  contacts: 'truth',
  contracts: 'truth',
  cost_centers: 'truth',
  credit_notes: 'truth',
  currencies: 'truth',
  custom_field_sync_queue: 'truth',
  custom_field_values: 'truth',
  custom_fields: 'truth',
  customer_profiles: 'truth',
  debit_notes: 'truth',
  delivery_note_lines: 'truth',
  delivery_notes: 'truth',
  depreciation_schedules: 'truth',
  discount_rules: 'truth',
  doc_links: 'link',
  doc_postings: 'control',
  entity_attachments: 'truth',
  entity_versions: 'evidence',
  entity_view_fields: 'truth',
  entity_views: 'truth',
  fiscal_periods: 'truth',
  fx_rates: 'truth',
  goods_receipt_lines: 'truth',
  goods_receipts: 'truth',
  intercompany_transactions: 'truth',
  inventory_trace_links: 'link',
  item_groups: 'truth',
  items: 'truth',
  journal_entries: 'truth',
  journal_lines: 'truth',
  landed_cost_allocations: 'truth',
  landed_cost_docs: 'truth',
  lot_tracking: 'truth',
  match_results: 'truth',
  meta_alias_resolution_rules: 'truth',
  meta_alias_sets: 'truth',
  meta_aliases: 'truth',
  meta_assets: 'truth',
  meta_lineage_edges: 'truth',
  meta_quality_checks: 'truth',
  meta_semantic_terms: 'truth',
  meta_term_links: 'link',
  meta_value_aliases: 'truth',
  migration_checkpoints: 'truth',
  migration_conflict_resolutions: 'truth',
  migration_conflicts: 'truth',
  migration_jobs: 'truth',
  migration_lineage: 'truth',
  migration_merge_explanations: 'truth',
  migration_quarantine: 'truth',
  migration_reports: 'truth',
  migration_row_snapshots: 'truth',
  mutation_batches: 'control',
  number_sequences: 'truth',
  org_usage_daily: 'truth',
  payment_allocations: 'truth',
  payment_terms: 'truth',
  payments: 'truth',
  price_list_items: 'truth',
  price_lists: 'truth',
  projects: 'truth',
  purchase_invoice_lines: 'truth',
  purchase_invoices: 'truth',
  purchase_order_lines: 'truth',
  purchase_orders: 'truth',
  purchase_requests: 'truth',
  quotation_lines: 'truth',
  quotations: 'truth',
  r2_files: 'system',
  reporting_snapshots: 'projection',
  revenue_schedule_lines: 'truth',
  revenue_schedules: 'truth',
  role_permissions: 'link',
  roles: 'system',
  sales_invoice_lines: 'truth',
  sales_invoices: 'truth',
  sales_order_lines: 'truth',
  sales_orders: 'truth',
  search_documents: 'projection',
  search_outbox: 'control',
  sites: 'truth',
  stock_balances: 'projection',
  stock_movements: 'truth',
  supplier_profiles: 'truth',
  tax_rates: 'truth',
  uom: 'truth',
  uom_conversions: 'truth',
  user_roles: 'system',
  user_scopes: 'system',
  users: 'system',
  warehouses: 'truth',
  webhook_deliveries: 'truth',
  webhook_endpoints: 'truth',
  wip_movements: 'truth',
  work_orders: 'truth',
  workflow_definitions: 'control',
  workflow_events_outbox: 'control',
  workflow_executions: 'control',
  workflow_instances: 'control',
  workflow_outbox_receipts: 'control',
  workflow_rules: 'control',
  workflow_side_effects_outbox: 'control',
  workflow_step_executions: 'control',
  workflow_step_receipts: 'control',
} as const satisfies Record<string, TableKind>;

/** Tables exempt from registry requirement (EX-SCH-*). */
export const REGISTRY_EXEMPT = new Set<string>([
  'search_backfill_state',
]);

/**
 * GAP-DB-005: RLS tables derived from TABLE_REGISTRY (tenant-scoped).
 * Excludes system (EX-RLS-001: users, r2_files use authUid).
 */
export const RLS_TABLES: readonly string[] = Object.entries(TABLE_REGISTRY)
  .filter(([, kind]) => kind !== 'system')
  .map(([name]) => name)
  .sort();

/**
 * Tables where UPDATE/DELETE is revoked (append-only or projection-only).
 * GAP-DB-003, Gate 6.
 */
export const REVOKE_UPDATE_DELETE_TABLES: readonly string[] = [
  'audit_logs',
  'stock_movements',
  'stock_balances',
  'wip_movements',
  'depreciation_schedules',
  'asset_events',
  'reporting_snapshots',
  'approval_decisions',
  'webhook_deliveries',
  'bank_statement_lines',
  'search_documents',
];
