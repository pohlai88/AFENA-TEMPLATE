<!-- AUTOGEN:START -->
<!-- Generated by afena readme gen â€” DO NOT EDIT inside this block -->
<!-- Signature: sha256:d60096332d28e1cf32a3a710e7dcdc445594f6dd8b319d69b4dda2ca8c172927 -->
# @afena/cli

## Package Overview

ğŸ“š Has Documentation â€¢ ğŸ“ 7 Subdirectories

### What's Inside

- Configuration
- Schemas
- Type definitions
- Utility functions

### Directory Structure

```
src/
â”œâ”€â”€ bundle/
â”œâ”€â”€ capability/
â”œâ”€â”€ checks/
â”œâ”€â”€ core/
â”œâ”€â”€ discovery/
â”œâ”€â”€ docs/
â””â”€â”€ readme/
```

### Entry Points

- `src/capability/adapter/index.ts`
- `src/capability/index.ts`
- `src/checks/index.ts`

## Usage

```bash
pnpm afena
```

### Build

```bash
pnpm build
```

### Development

```bash
pnpm dev
```

## Exports

| Subpath | Conditions |
|---|---|
| `.` | default: `dist/index.js`, types: `dist/index.d.ts` |

## Scripts

| Script | Command |
|---|---|
| `build` | `tsup` |
| `dev` | `tsup --watch` |
| `lint` | `eslint src --ext .js,.jsx,.ts,.tsx --cache --concurrency=auto` |
| `lint:ci` | `eslint src --ext .js,.jsx,.ts,.tsx --rule 'import/no-cycle: error'` |
| `lint:fix` | `eslint src --ext .js,.jsx,.ts,.tsx --cache --fix` |
| `meta:check` | `node dist/index.js meta check` |
| `type-check` | `tsc --noEmit` |

## Architecture

CLI tool built with Commander.js.

## Dependencies

| Package | Version |
|---|---|
| `afena-canon` | `workspace:*` |
| `commander` | `catalog:` |
| `cosmiconfig` | `catalog:` |
| `execa` | `catalog:` |
| `fast-glob` | `catalog:` |
| `listr2` | `catalog:` |
| `picocolors` | `catalog:` |
| `semver` | `catalog:` |
| `strip-ansi` | `catalog:` |
| `zod` | `catalog:` |

## Related Packages

- `afena-canon`
- `afena-eslint-config`
- `afena-typescript-config`

## Contributing

### Development Workflow

1. Make changes to source files
2. Run `pnpm lint:fix` to fix linting issues
3. Run `pnpm type-check` to verify types

### Code Quality

- All code must pass ESLint checks
- All code must pass TypeScript type checking

<!-- AUTOGEN:END -->

# @afena/cli

Afena CLI â€” capability governance, README generation, entity scaffolding, and architecture doc generation.

## Commands

| Command                                           | Description                                                               |
| ------------------------------------------------- | ------------------------------------------------------------------------- |
| `afena meta gen [--deep]`                         | Scan surfaces, generate ledger + matrix + manifest + mermaid + AI context |
| `afena meta check [--deep] [--json]`              | Run VIS-00 through VIS-04 checks (exits non-zero on failure)              |
| `afena meta fix [--dry-run]`                      | Autofix missing capability annotations                                    |
| `afena meta matrix`                               | Generate and print the capability matrix                                  |
| `afena meta manifest`                             | Generate codebase manifest (package graph, schema catalog, stats)         |
| `afena readme gen [--package <name>] [--dry-run]` | Generate READMEs + architecture docs                                      |
| `afena readme sync [--dry-run]`                   | Update autogen blocks for existing READMEs only                           |
| `afena readme check`                              | Validate READMEs against Definition of Done                               |

## Architecture Doc Generation

Running `afena readme gen` auto-generates `.architecture/*.architecture.md` files from live codebase introspection.

Each doc combines:

- **Static descriptions** from `ARCH_REGISTRY` (overview, design decisions, data flow, cross-refs)
- **Live introspected data** (barrel exports, source dirs, types, invariants, deps, patterns, test counts)

### Adding a New Architecture Document

1. Open `tools/afena-cli/src/meta/emitters/architecture.ts`
2. Add an entry to `ARCH_REGISTRY` keyed by **package name** (from `package.json`) or **relative path** (e.g. `apps/web`):

```ts
'afena-my-package': {
  title: 'My Package',
  filename: 'my-package.architecture',   // â†’ .architecture/my-package.architecture.md
  purpose: 'One-line purpose statement.',
  overview: `
Markdown describing the architecture overview.
`,
  decisions: `
- **Decision 1**: Explanation
- **Decision 2**: Explanation
`,
  dataFlow: `           // optional
\`\`\`
A â†’ B â†’ C
\`\`\`
`,
  integrations: `...`,  // optional
  crossRefs: ['database.architecture.md', 'crud.architecture.md'],  // optional
},
```

3. Rebuild the CLI: `pnpm build` (from `tools/afena-cli`)
4. Run: `pnpm afena readme gen`

### Currently Registered Packages

| Registry Key      | Output File                 | Package              |
| ----------------- | --------------------------- | -------------------- |
| `afena-canon`     | `canon.architecture.md`     | `packages/canon`     |
| `afena-crud`      | `crud.architecture.md`      | `packages/crud`      |
| `afena-database`  | `database.architecture.md`  | `packages/database`  |
| `afena-search`    | `search.architecture.md`    | `packages/search`    |
| `afena-workflow`  | `workflow.architecture.md`  | `packages/workflow`  |
| `afena-advisory`  | `advisory.architecture.md`  | `packages/advisory`  |
| `afena-migration` | `migration.architecture.md` | `packages/migration` |
| `afena-logger`    | `logger.architecture.md`    | `packages/logger`    |
| `afena-ui`        | `ui.architecture.md`        | `packages/ui`        |
| `apps/web`        | `route.architecture.md`     | `apps/web`           |
| `tools/afena-cli` | `meta.architecture.md`      | `tools/afena-cli`    |

### Manual Architecture Docs (not auto-generated)

These files in `.architecture/` are **not** in `ARCH_REGISTRY` and are never overwritten:

- `business.logic.architecture.md` â€” cross-cutting CRUD-SAP kernel pattern
- `multitenancy.architecture.md` â€” shared schema + RLS model
- `db.schema.governance.md` â€” schema lint rules and governance
